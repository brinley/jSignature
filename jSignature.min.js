/*

jSignature v2
Copyright (c) 2012 Willow Systems Corp http://willow-systems.com
Copyright (c) 2010 Brinley Ang http://www.unbolt.net
MIT License <http://www.opensource.org/licenses/mit-license.php> 


jSignature v2 jSignature's custom "base30" format export and import plugins.
Copyright (c) 2011 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>


Simplify.js BSD 
(c) 2012, Vladimir Agafonkin
mourner.github.com/simplify-js


base64 encoder
MIT, GPL
http://phpjs.org/functions/base64_encode
+   original by: Tyler Akins (http://rumkin.com)
+   improved by: Bayron Guevara
+   improved by: Thunder.m
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   bugfixed by: Pellentesque Malesuada
+   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
+   improved by: Rafal Kukawski (http://kukawski.pl)


jSignature v2 SVG export plugin.
Copyright (c) 2012 Willow Systems Corp http://willow-systems.com
MIT License <http://www.opensource.org/licenses/mit-license.php>

*/
(function(){if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");(function(j){function p(a){for(var b,d=a.css("color"),c;void 0===c&&void 0!==a;){try{b=a.css("background-color")}catch(e){b="transparent"}"transparent"!==b&&"rgba(0, 0, 0, 0)"!==b&&(c=b);try{a=a.parent(),a[0]===document&&(a=void 0)}catch(f){a=void 0}}var a=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,g=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,
h;b=void 0;(b=d.match(a))?h={r:parseInt(b[1],10),g:parseInt(b[2],10),b:parseInt(b[3],10)}:(b=d.match(g))&&(h={r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)});var k;c?(b=void 0,(b=c.match(a))?k={r:parseInt(b[1],10),g:parseInt(b[2],10),b:parseInt(b[3],10)}:(b=c.match(g))&&(k={r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)})):k=h?127<Math.max.apply(null,[h.r,h.g,h.b])?{r:0,g:0,b:0}:{r:255,g:255,b:255}:{r:255,g:255,b:255};b=function(a){return"rgb("+[a.r,a.g,a.b].join(", ")+
")"};h&&k?(a=Math.max.apply(null,[h.r,h.g,h.b]),h=Math.max.apply(null,[k.r,k.g,k.b]),h=Math.round(h+-0.75*(h-a)),h={r:h,g:h,b:h}):h?(h=Math.max.apply(null,[h.r,h.g,h.b]),a=1,127<h&&(a=-1),h=Math.round(h+96*a),h={r:h,g:h,b:h}):h={r:191,g:191,b:191};return{color:d,"background-color":k?b(k):c,"decor-color":b(h)}}function i(a,b){this.x=a;this.y=b;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,
2)+Math.pow(this.y,2)));return this._length};var d=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(a){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=a,this.y=a*d(this.y);else if(0===this.y)this._length=a,this.x=a*d(this.x);else{var b=Math.abs(this.y/this.x),c=Math.sqrt(Math.pow(a,2)/(1+Math.pow(b,2))),b=b*c;this._length=a;this.x=c*d(this.x);this.y=b*d(this.y)}return this};this.angleTo=function(a){var b=this.getLength()*a.getLength();return 0===b?0:Math.acos(Math.min(Math.max((this.x*
a.x+this.y*a.y)/b,-1),1))/Math.PI}}function l(a,b){this.x=a;this.y=b;this.getVectorToCoordinates=function(a,b){return new i(a-this.x,b-this.y)};this.getVectorFromCoordinates=function(a,b){return this.getVectorToCoordinates(a,b).reverse()};this.getVectorToPoint=function(a){return new i(a.x-this.x,a.y-this.y)};this.getVectorFromPoint=function(a){return this.getVectorToPoint(a).reverse()}}function q(a){this.data=a;this.changed=function(){};this.startStrokeFn=function(){};this.addToStrokeFn=function(){};
this.endStrokeFn=function(){};this.inStroke=!1;this._stroke=this._lastPoint=null;this.startStroke=function(a){if(a&&"number"==typeof a.x&&"number"==typeof a.y){this._stroke={x:[a.x],y:[a.y]};this.data.push(this._stroke);this._lastPoint=a;this.inStroke=!0;var d=this._stroke,c=this.startStrokeFn;setTimeout(function(){c(d)},3);return a}return null};this.addToStroke=function(a){if(this.inStroke&&"number"===typeof a.x&&"number"===typeof a.y&&4<Math.abs(a.x-this._lastPoint.x)+Math.abs(a.y-this._lastPoint.y)){var d=
this._stroke.x.length;this._stroke.x.push(a.x);this._stroke.y.push(a.y);this._lastPoint=a;var c=this._stroke,e=this.addToStrokeFn;setTimeout(function(){e(c,d)},3);return a}return null};this.endStroke=function(){var a=this.inStroke;this.inStroke=!1;this._lastPoint=null;if(a){var d=this.endStrokeFn,c=this._stroke;setTimeout(function(){d(c)},3);setTimeout(this.changed,3);return!0}return null}}function r(a,b){var d=new Image,c=this;d.onload=function(){c.getContext("2d").drawImage(d,0,0,d.width<c.width?
d.width:c.width,d.height<c.height?d.height:c.height)};d.src="data:"+b+","+a}function t(a){this.find("canvas."+g).add(this.filter("canvas."+g)).data(g+".reset")(a);return this}function n(a,b){if(void 0===b&&("string"===typeof a&&"data:"===a.substr(0,5))&&(b=a.slice(5).split(",")[0],a=a.slice(6+b.length),b===a))return;var d=this.find("canvas."+g).add(this.filter("canvas."+g));if(c.hasOwnProperty(b))0!==d.length&&c[b].call(d[0],a,b,d.data(g+".reset"));else throw Error(g+" is unable to find import plugin with for format '"+
(""+b)+"'");return this}var g="jSignature",z={},B=function(a){var b={},d={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10},c=j(this);j.extend(d,p(c));a&&j.extend(d,a);d.width===d.height&&"ratio"===d.height&&(d.width="100%");var e=document.createElement("canvas"),f=j(e);f.css("margin",0).css("padding",0).css("border","none").css("height","ratio"===d.height||!d.height?1:d.height.toString(10)).css("width","ratio"===
d.width||!d.width?1:d.width.toString(10));f.appendTo(c);"ratio"===d.height?f.css("height",Math.round(f.width()/d.sizeRatio)):"ratio"===d.width&&f.css("width",Math.round(f.height()*d.sizeRatio));f.addClass(g);e.width=f.width();e.height=f.height();var m=function(){if(e.getContext)return false;if(typeof FlashCanvas!=="undefined"){e=FlashCanvas.initElement(e);var a=1;window&&(window.screen&&window.screen.deviceXDPI&&window.screen.logicalXDPI)&&(a=window.screen.deviceXDPI*1/window.screen.logicalXDPI);
if(a!==1){f.children("object").get(0).resize(Math.ceil(e.width*a),Math.ceil(e.height*a));e.getContext("2d").scale(a,a)}return true}throw Error("Canvas element does not support 2d context. "+g+" cannot proceed.");}();d.lineWidth=0===d.lineWidth?Math.max(Math.round(e.width/400),2):d.lineWidth;var h=600>e.width?!0:!1;e.onselectstart=function(a){a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation();return false};d.cssclass&&""!=j.trim(d.cssclass)&&f.addClass(d.cssclass);var k=
e.getContext("2d"),D,o,r,t,u,n,K=-1*Math.round(d.lineWidth/2),G=function(a,b,d,c){k.beginPath();k.moveTo(a,b);k.lineTo(d,c);k.stroke()},a=function(a){var b=e.width,A=e.height;k.clearRect(0,0,b+30,A+30);k.shadowColor=k.fillStyle=d["background-color"];m&&k.fillRect(0,0,b+30,A+30);k.lineWidth=Math.ceil(parseInt(d.lineWidth,10));k.lineCap=k.lineJoin="round";var i=Math.round(A/5);k.strokeStyle=d["decor-color"];k.shadowOffsetX=0;k.shadowOffsetY=0;G(i*1.5,A-i,b-i*1.5,A-i);k.strokeStyle=d.color;if(!m&&!h){k.shadowColor=
k.strokeStyle;k.shadowOffsetX=k.lineWidth*0.5;k.shadowOffsetY=k.lineWidth*-0.6;k.shadowBlur=0}if(a===void 0)a=[];else for(var b=a.length,j=0;j<b;j++){A=a[j];i=A.x.length;o(A);for(var H=1;H<i;H++)r(A,H);t(A)}D=new q(a);D.startStrokeFn=o;D.addToStrokeFn=r;D.endStrokeFn=t;D.changed=function(){c.trigger("change")};f.data(g+".data",a);d.data=a;f.data(g+".settings",d);return true},v=null,w=function(a){try{a.preventDefault()}catch(b){}clearTimeout(v);D.endStroke()},B=0,L=function(a){a=a.changedTouches&&
a.changedTouches.length>0?a.changedTouches[0]:a;return new l(Math.round(a.pageX+u),Math.round(a.pageY+n)+B)},F=function(a){a.preventDefault();var b=f.offset();u=b.left*-1;n=b.top*-1;D.startStroke(L(a));clearTimeout(v);v=setTimeout(w,750)},I=function(a){a.preventDefault();if(D.inStroke&&D.addToStroke(L(a))){clearTimeout(v);v=setTimeout(w,750)}},J=3*d.lineWidth;o=function(a){var b=a.x[0],a=a.y[0];k.fillStyle=d.color;k.fillRect(b+K,a+K,d.lineWidth,d.lineWidth);k.fillStyle=d["background-color"]};r=function(a,
b){var d=new l(a.x[b-1],a.y[b-1]),c=new l(a.x[b],a.y[b]),e=d.getVectorToPoint(c);if(b>1){var f=new l(a.x[b-2],a.y[b-2]),h=f.getVectorToPoint(d),s;if(h.getLength()>J){s=b>2?(new l(a.x[b-3],a.y[b-3])).getVectorToPoint(f):new i(0,0);var g=h.getLength()*0.35,C=h.angleTo(s.reverse()),E=e.angleTo(h.reverse());s=(new i(s.x+h.x,s.y+h.y)).resizeTo(Math.max(0.05,C)*g);var j=(new i(h.x+e.x,h.y+e.y)).reverse().resizeTo(Math.max(0.05,E)*g),h=f.x,g=f.y,E=d.x,C=d.y,m=f.x+s.x,f=f.y+s.y;s=d.x+j.x;j=d.y+j.y;k.beginPath();
k.moveTo(h,g);k.bezierCurveTo(m,f,s,j,E,C);k.stroke()}}e.getLength()<=J&&G(d.x,d.y,c.x,c.y)};t=function(a){var b=a.x.length-1;if(b>0){var d=new l(a.x[b],a.y[b]),c=new l(a.x[b-1],a.y[b-1]),e=c.getVectorToPoint(d);if(e.getLength()>J)if(b>1){var a=(new l(a.x[b-2],a.y[b-2])).getVectorToPoint(c),f=(new i(a.x+e.x,a.y+e.y)).resizeTo(e.getLength()/2),e=c.x,a=c.y,b=d.x,h=d.y,s=c.x+f.x,c=c.y+f.y,f=d.x,d=d.y;k.beginPath();k.moveTo(e,a);k.bezierCurveTo(s,c,f,d,b,h);k.stroke()}else G(c.x,c.y,d.x,d.y)}};m?f.bind("mousedown."+
g,function(a){f.unbind("mousedown."+g);F(a);f.bind("mousemove."+g,I);f.bind("mouseup."+g,w);f.bind("mousedown."+g,F)}):(e.ontouchstart=function(a){e.onmousedown=null;e.onmouseup=null;e.onmousemove=null;B=d.minFatFingerCompensation&&d.lineWidth*-3>d.minFatFingerCompensation?d.lineWidth*-3:d.minFatFingerCompensation;F(a);e.ontouchend=w;e.ontouchstart=F;e.ontouchmove=I},e.onmousedown=function(a){e.ontouchstart=null;e.ontouchend=null;e.ontouchmove=null;F(a);e.onmousedown=F;e.onmouseup=w;e.onmousemove=
I});f.data(g+".reset",a);(function(a){return a==="ratio"||a.split("")[a.length-1]==="%"})(d.width.toString(10))&&(b[g+".parentresized"]=j.fn[g]("PubSub").subscribe(g+".parentresized",function(a,b,d,c){return function(){var e=d.width();if(e!==c){var f=d[b]("PubSub"),h;for(h in a)if(a.hasOwnProperty(h)){f.unsubscribe(a[h]);delete a[h]}h=d.find("canvas");f=h.data(b+".settings");h.remove();h=f.data;var e=e*1/c,k=[],s,g,i,C,j,E;g=0;for(i=h.length;g<i;g++){E=h[g];s={x:[],y:[]};C=0;for(j=E.x.length;C<j;C++){s.x.push(E.x[C]*
e);s.y.push(E.y[C]*e)}k.push(s)}f.data=k;d[b](f)}}}(b,g,c,c.width(),1*e.width/e.height)));z.windowresize||(z.windowresize=!0,function(a,b,d){var c,e=function(){b.fn[a]("PubSub").publish(a+".parentresized")};b(d).bind("resize."+a,function(){c&&clearTimeout(c);c=setTimeout(e,700)})}(g,j,window));b[g+".windowmouseup"]=j.fn[g]("PubSub").subscribe(g+".windowmouseup",w);z.windowmouseup||(z.windowmouseup=!0,function(a,b,d){b(d).bind("mouseup."+a,function(d){b.fn[a]("PubSub").publish(a+".windowmouseup",d)})}(g,
j,window));a(d.data)},o={"default":function(){return this.toDataURL()},"native":function(a){return a},image:function(){var a=this.toDataURL();if("string"===typeof a&&4<a.length&&"data:"===a.slice(0,5)&&-1!==a.indexOf(",")){var b=a.indexOf(",");return[a.slice(5,b),a.substr(b+1)]}return[]}},c={"native":function(a,b,d){d(a)},image:r,"image/png;base64":r,"image/jpeg;base64":r,"image/jpg;base64":r},f=new function(){this.topics={};this.publish=function(a,b,d,c){if(this.topics[a])for(var e=this.topics[a],
f=Array.prototype.slice.call(arguments,1),g=0,h=e.length;g<h;g++)e[g].apply(null,f)};this.subscribe=function(a,b){this.topics[a]?this.topics[a].push(b):this.topics[a]=[b];return{topic:a,callback:b}};this.unsubscribe=function(a){if(this.topics[a.topic])for(var b=this.topics[a.topic],d=0,c=b.length;d<c;d++)b[d]===a.callback&&b.splice(d,1)}},e={init:function(a){return this.each(function(){B.call(this,a)})},getSettings:function(){return this.find("canvas."+g).add(this.filter("canvas."+g)).data(g+".settings")},
clear:t,reset:t,addPlugin:function(a,b,d){var e={"export":o,"import":c};e.hasOwnProperty(a)&&(e[a][b]=d);return this},listPlugins:function(a){var b={"export":o,"import":c},d=[];if(b.hasOwnProperty(a)){var a=b[a],e;for(e in a)a.hasOwnProperty(e)&&d.push(e)}return d},getData:function(a){var b=this.find("canvas."+g).add(this.filter("canvas."+g));void 0===a&&(a="default");if(0!==b.length&&o.hasOwnProperty(a))return o[a].call(b.get(0),b.data(g+".data"))},importData:n,setData:n,PubSub:function(){return f}};
j.fn[g]=function(a){if(!a||"object"===typeof a)return e.init.apply(this,arguments);if("string"===typeof a&&e[a])return e[a].apply(this,Array.prototype.slice.call(arguments,1));j.error("Method "+a+" does not exist on jQuery."+g)}})(this.jQuery)})("undefined"!==typeof window?window:this);
(function(){for(var j={},p={},i="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWX".split(""),l=i.length/2,q=l-1;-1<q;q--)j[i[q]]=i[q+l],p[i[q+l]]=i[q];var r=function(c){for(var c=c.split(""),f=c.length,e=1;e<f;e++)c[e]=j[c[e]];return c.join("")},t=function(c){for(var f=[],e=0,a=1,b=c.length,d,g,i=0;i<b;i++)d=Math.round(c[i]),g=d-e,e=d,0>g&&0<a?(a=-1,f.push("Z")):0<g&&0>a&&(a=1,f.push("Y")),d=Math.abs(g),d>=l?f.push(r(d.toString(l))):f.push(d.toString(l));return f.join("")},n=function(c){for(var f=
[],c=c.split(""),e=c.length,a,b=1,d=[],g=0,i=0;i<e;i++)(a=c[i],a in j||"Z"===a||"Y"===a)?(0!==d.length&&(d=parseInt(d.join(""),l)*b+g,f.push(d),g=d),"Z"===a)?(b=-1,d=[]):"Y"===a?(b=1,d=[]):d=[a]:d.push(p[a]);f.push(parseInt(d.join(""),l)*b+g);return f},g=function(c){for(var f=[],e=c.length,a,b=0;b<e;b++)a=c[b],f.push(t(a.x)),f.push(t(a.y));return f.join("_")},z=function(c){for(var f=[],c=c.split("_"),e=c.length/2,a=0;a<e;a++)f.push({x:n(c[2*a]),y:n(c[2*a+1])});return f},B=function(c){return["image/jsignature;base30",
g(c)]},o=function(c,f,e){"string"===typeof c&&("image/jsignature;base30"===c.substring(0,23).toLowerCase()&&(c=c.substring(24)),e(z(c)))};if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");(function(c){c=c.fn.jSignature;c("addPlugin","export","base30",B);c("addPlugin","export","image/jsignature;base30",B);c("addPlugin","import","base30",o);c("addPlugin","import","image/jsignature;base30",o)})(this.jQuery);this.jSignatureDebug&&
(this.jSignatureDebug.base30={remapTailChars:r,compressstrokeleg:t,uncompressstrokeleg:n,compressstrokes:g,uncompressstrokes:z,charmap:j})}).call("undefined"!==typeof window?window:this);
(function(){function j(c,f){this.x=c;this.y=f;this.reverse=function(){return new this.constructor(-1*this.x,-1*this.y)};this._length=null;this.getLength=function(){this._length||(this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return this._length};var e=function(a){return Math.round(a/Math.abs(a))};this.resizeTo=function(a){if(0===this.x&&0===this.y)this._length=0;else if(0===this.x)this._length=a,this.y=a*e(this.y);else if(0===this.y)this._length=a,this.x=a*e(this.x);else{var b=Math.abs(this.y/
this.x),d=Math.sqrt(Math.pow(a,2)/(1+Math.pow(b,2))),b=b*d;this._length=a;this.x=d*e(this.x);this.y=b*e(this.y)}return this};this.angleTo=function(a){var b=this.getLength()*a.getLength();return 0===b?0:Math.acos(Math.min(Math.max((this.x*a.x+this.y*a.y)/b,-1),1))/Math.PI}}function p(c,f){this.x=c;this.y=f;this.getVectorToCoordinates=function(c,a){return new j(c-this.x,a-this.y)};this.getVectorFromCoordinates=function(c,a){return this.getVectorToCoordinates(c,a).reverse()};this.getVectorToPoint=function(c){return new j(c.x-
this.x,c.y-this.y)};this.getVectorFromPoint=function(c){return this.getVectorToPoint(c).reverse()}}function i(c,f){var e=Math.pow(10,f);return Math.round(c*e)/e}function l(c,f,e){var f=f+1,a=new p(c.x[f-1],c.y[f-1]),b=new p(c.x[f],c.y[f]),b=a.getVectorToPoint(b),d=new p(c.x[f-2],c.y[f-2]),a=d.getVectorToPoint(a);return a.getLength()>e?(e=2<f?(new p(c.x[f-3],c.y[f-3])).getVectorToPoint(d):new j(0,0),c=0.35*a.getLength(),d=a.angleTo(e.reverse()),f=b.angleTo(a.reverse()),e=(new j(e.x+a.x,e.y+a.y)).resizeTo(Math.max(0.05,
d)*c),b=(new j(a.x+b.x,a.y+b.y)).reverse().resizeTo(Math.max(0.05,f)*c),b=new j(a.x+b.x,a.y+b.y),["c",i(e.x,2),i(e.y,2),i(b.x,2),i(b.y,2),i(a.x,2),i(a.y,2)]):["l",i(a.x,2),i(a.y,2)]}function q(c,f){var e=c.x.length-1,a=new p(c.x[e],c.y[e]),b=new p(c.x[e-1],c.y[e-1]),a=b.getVectorToPoint(a);if(1<e&&a.getLength()>f){var e=(new p(c.x[e-2],c.y[e-2])).getVectorToPoint(b),b=a.angleTo(e.reverse()),d=0.35*a.getLength(),e=(new j(e.x+a.x,e.y+a.y)).resizeTo(Math.max(0.05,b)*d);return["c",i(e.x,2),i(e.y,2),i(a.x,
2),i(a.y,2),i(a.x,2),i(a.y,2)]}return["l",i(a.x,2),i(a.y,2)]}function r(c,f,e){for(var f=["M",x=i(c.x[0]-f,2),y=i(c.y[0]-e,2)],e=1,a=c.x.length-1;e<a;e++)f.push.apply(f,l(c,e,1));0<a?f.push.apply(f,q(c,e,1)):0===a&&f.push.apply(f,["l",1,1]);return f.join(" ")}function t(c){var f=['<?xml version="1.0" encoding="UTF-8" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'],e,a=c.length,b,d=[],g=[],i=b=e=0,j=0,m=[];if(0!==a){for(e=0;e<
a;e++){i=c[e];j=[];b={x:[],y:[]};for(var h=void 0,k=void 0,h=0,k=i.x.length;h<k;h++)j.push({x:i.x[h],y:i.y[h]});j=simplify(j,0.7,!0);h=0;for(k=j.length;h<k;h++)b.x.push(j[h].x),b.y.push(j[h].y);m.push(b);d=d.concat(b.x);g=g.concat(b.y)}c=Math.min.apply(null,d)-1;a=Math.max.apply(null,d)+1;d=Math.min.apply(null,g)-1;g=Math.max.apply(null,g)+1;i=0>c?0:c;j=0>d?0:d;e=a-c;b=g-d}f.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="'+e.toString()+'" height="'+b.toString()+'">');e=0;for(a=
m.length;e<a;e++)b=m[e],f.push('<path fill="none" stroke="#000000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="'+r(b,i,j)+'"/>');f.push("</svg>");return f.join("")}function n(c){return[B,t(c)]}function g(c){return[o,z(t(c))]}(function(c,f){"use strict";(typeof exports!=f+""?exports:c).simplify=function(c,a,b){a=a!==f?a*a:1;if(!b){for(var d=c.length,g,i=c[0],j=[i],b=1;b<d;b++){g=c[b];var m=g.x-i.x,h=g.y-i.y;m*m+h*h>a&&(j.push(g),i=g)}c=(i!==g&&j.push(g),j)}g=c;var b=g.length,
d=new (typeof Uint8Array!=f+""?Uint8Array:Array)(b),i=0,j=b-1,k,l,o=[],r=[],t=[];for(d[i]=d[j]=1;j;){h=0;for(m=i+1;m<j;m++){k=g[m];var u=g[i],p=g[j],n=u.x,q=u.y,u=p.x-n,v=p.y-q,w=void 0;if(0!==u||0!==v)w=((k.x-n)*u+(k.y-q)*v)/(u*u+v*v),1<w?(n=p.x,q=p.y):0<w&&(n+=u*w,q+=v*w);k=(u=k.x-n,v=k.y-q,u*u+v*v);k>h&&(l=m,h=k)}h>a&&(d[l]=1,o.push(i),r.push(l),o.push(l),r.push(j));i=o.pop();j=r.pop()}for(m=0;m<b;m++)d[m]&&t.push(g[m]);return c=t,c}})(this);if("function"!==typeof z)var z=function(c){var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),
e,a,b,d,g=0,i=0,j="",j=[];do e=c.charCodeAt(g++),a=c.charCodeAt(g++),b=c.charCodeAt(g++),d=e<<16|a<<8|b,e=d>>18&63,a=d>>12&63,b=d>>6&63,d&=63,j[i++]=f[e]+f[a]+f[b]+f[d];while(g<c.length);j=j.join("");c=c.length%3;return(c?j.slice(0,c-3):j)+"===".slice(c||3)};var B="image/svg+xml",o="image/svg+xml;base64";if(null==this.jQuery)throw Error("We need jQuery for some of the functionality. jQuery is not detected. Failing to initialize...");(function(c){c=c.fn.jSignature;c("addPlugin","export","svg",n);c("addPlugin",
"export",B,n);c("addPlugin","export","svgbase64",g);c("addPlugin","export",o,g)})(this.jQuery)}).call("undefined"!==typeof window?window:this);